{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport * as ImagePicker from 'expo-image-picker';\nimport { Supabase } from \"../../config/supabaseConfig\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Avatar(_ref) {\n  var url = _ref.url,\n    _ref$size = _ref.size,\n    size = _ref$size === void 0 ? 150 : _ref$size,\n    onUpload = _ref.onUpload;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    uploading = _useState2[0],\n    setUploading = _useState2[1];\n  var _ref2 = useState < string | null > null,\n    _ref3 = _slicedToArray(_ref2, 2),\n    avatarUrl = _ref3[0],\n    setAvatarUrl = _ref3[1];\n  var avatarSize = {\n    height: size,\n    width: size\n  };\n  useEffect(function () {\n    if (url) downloadImage(url);\n  }, [url]);\n  function downloadImage(_x) {\n    return _downloadImage.apply(this, arguments);\n  }\n  function _downloadImage() {\n    _downloadImage = _asyncToGenerator(function* (path) {\n      try {\n        var _yield$Supabase$stora = yield Supabase.storage.from('avatars').download(path),\n          data = _yield$Supabase$stora.data,\n          error = _yield$Supabase$stora.error;\n        if (error) {\n          throw error;\n        }\n        var fr = new FileReader();\n        fr.readAsDataURL(data);\n        fr.onload = function () {\n          setAvatarUrl(fr.result);\n        };\n      } catch (error) {\n        if (error instanceof Error) {\n          console.log('Error downloading image: ', error.message);\n        }\n      }\n    });\n    return _downloadImage.apply(this, arguments);\n  }\n  function uploadAvatar() {\n    return _uploadAvatar.apply(this, arguments);\n  }\n  function _uploadAvatar() {\n    _uploadAvatar = _asyncToGenerator(function* () {\n      try {\n        setUploading(true);\n        var result = yield ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images,\n          allowsEditing: true,\n          aspect: [1, 1],\n          quality: 1\n        });\n        if (result.cancelled) {\n          console.warn('Image picker cancelled');\n          return;\n        }\n        var uri = result.uri,\n          type = result.type,\n          name = result.name;\n        var formData = new FormData();\n        formData.append('file', {\n          uri: uri,\n          type: type,\n          name: name\n        });\n        var fileExt = name.split('.').pop();\n        var filePath = `${Math.random()}.${fileExt}`;\n        var _yield$Supabase$stora2 = yield Supabase.storage.from('avatars').upload(filePath, formData),\n          uploadError = _yield$Supabase$stora2.error;\n        if (uploadError) {\n          throw uploadError;\n        }\n        onUpload(filePath);\n      } catch (error) {\n        if (error instanceof Error) {\n          Alert.alert(error.message);\n        } else {\n          throw error;\n        }\n      } finally {\n        setUploading(false);\n      }\n    });\n    return _uploadAvatar.apply(this, arguments);\n  }\n  return _jsxs(View, {\n    children: [avatarUrl ? _jsx(Image, {\n      source: {\n        uri: avatarUrl\n      },\n      accessibilityLabel: \"Avatar\",\n      style: [avatarSize, styles.avatar, styles.image]\n    }) : _jsx(View, {\n      style: [avatarSize, styles.avatar, styles.noImage]\n    }), _jsx(View, {\n      children: _jsx(Button, {\n        title: uploading ? 'Uploading ...' : 'Upload',\n        onPress: uploadAvatar,\n        disabled: uploading\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  avatar: {\n    borderRadius: 5,\n    overflow: 'hidden',\n    maxWidth: '100%'\n  },\n  image: {\n    objectFit: 'cover',\n    paddingTop: 0\n  },\n  noImage: {\n    backgroundColor: '#333',\n    borderWidth: 1,\n    borderColor: 'rgb(200, 200, 200)',\n    borderRadius: 5\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","View","Image","Button","Alert","StyleSheet","ImagePicker","Supabase","jsx","_jsx","jsxs","_jsxs","Avatar","_ref","url","_ref$size","size","onUpload","_useState","_useState2","_slicedToArray","uploading","setUploading","_ref2","string","_ref3","avatarUrl","setAvatarUrl","avatarSize","height","width","downloadImage","_x","_downloadImage","apply","arguments","_asyncToGenerator","path","_yield$Supabase$stora","storage","from","download","data","error","fr","FileReader","readAsDataURL","onload","result","Error","console","log","message","uploadAvatar","_uploadAvatar","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","cancelled","warn","uri","type","name","formData","FormData","append","fileExt","split","pop","filePath","Math","random","_yield$Supabase$stora2","upload","uploadError","alert","children","source","accessibilityLabel","style","styles","avatar","image","noImage","title","onPress","disabled","create","borderRadius","overflow","maxWidth","objectFit","paddingTop","backgroundColor","borderWidth","borderColor"],"sources":["D:/Moco/PartyPilot/src/components/ProfileImage/ProfileImage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { View, Image, Button, Alert, StyleSheet } from 'react-native';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport { Supabase } from '../../config/supabaseConfig'; // Import your Supabase setup\r\n\r\nexport default function Avatar({ url, size = 150, onUpload }) {\r\n  const [uploading, setUploading] = useState(false);\r\n  const [avatarUrl, setAvatarUrl] = useState<string | null>(null);\r\n  const avatarSize = { height: size, width: size };\r\n\r\n  useEffect(() => {\r\n    if (url) downloadImage(url);\r\n  }, [url]);\r\n\r\n  async function downloadImage(path) {\r\n    try {\r\n      const { data, error } = await Supabase.storage.from('avatars').download(path);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n\r\n      const fr = new FileReader();\r\n      fr.readAsDataURL(data);\r\n      fr.onload = () => {\r\n        setAvatarUrl(fr.result);\r\n      };\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        console.log('Error downloading image: ', error.message);\r\n      }\r\n    }\r\n  }\r\n\r\n  async function uploadAvatar() {\r\n    try {\r\n      setUploading(true);\r\n\r\n      const result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsEditing: true,\r\n        aspect: [1, 1],\r\n        quality: 1,\r\n      });\r\n\r\n      if (result.cancelled) {\r\n        console.warn('Image picker cancelled');\r\n        return;\r\n      }\r\n\r\n      const { uri, type, name } = result;\r\n\r\n      const formData = new FormData();\r\n      formData.append('file', { uri, type, name });\r\n\r\n      const fileExt = name.split('.').pop();\r\n      const filePath = `${Math.random()}.${fileExt}`;\r\n\r\n      const { error: uploadError } = await Supabase.storage\r\n        .from('avatars')\r\n        .upload(filePath, formData);\r\n\r\n      if (uploadError) {\r\n        throw uploadError;\r\n      }\r\n\r\n      onUpload(filePath);\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        Alert.alert(error.message);\r\n      } else {\r\n        throw error;\r\n      }\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <View>\r\n      {avatarUrl ? (\r\n        <Image\r\n          source={{ uri: avatarUrl }}\r\n          accessibilityLabel=\"Avatar\"\r\n          style={[avatarSize, styles.avatar, styles.image]}\r\n        />\r\n      ) : (\r\n        <View style={[avatarSize, styles.avatar, styles.noImage]} />\r\n      )}\r\n      <View>\r\n        <Button\r\n          title={uploading ? 'Uploading ...' : 'Upload'}\r\n          onPress={uploadAvatar}\r\n          disabled={uploading}\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  avatar: {\r\n    borderRadius: 5,\r\n    overflow: 'hidden',\r\n    maxWidth: '100%',\r\n  },\r\n  image: {\r\n    objectFit: 'cover',\r\n    paddingTop: 0,\r\n  },\r\n  noImage: {\r\n    backgroundColor: '#333',\r\n    borderWidth: 1,\r\n    borderColor: 'rgb(200, 200, 200)',\r\n    borderRadius: 5,\r\n  },\r\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}