{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = ProfileImage;\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _StyleSheet = _interopRequireDefault(require(\"react-native-web/dist/exports/StyleSheet\"));\nvar _View = _interopRequireDefault(require(\"react-native-web/dist/exports/View\"));\nvar _Image = _interopRequireDefault(require(\"react-native-web/dist/exports/Image\"));\nvar _ActivityIndicator = _interopRequireDefault(require(\"react-native-web/dist/exports/ActivityIndicator\"));\nvar _Alert = _interopRequireDefault(require(\"react-native-web/dist/exports/Alert\"));\nvar _constants = require(\"../../constants\");\nvar _supabaseConfig = require(\"../../config/supabaseConfig\");\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _jsxFileName = \"D:\\\\Moco\\\\PartyPilot\\\\src\\\\components\\\\ProfileImage\\\\ProfileImage.jsx\";\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction ProfileImage(_ref) {\n  var dimension = _ref.dimension,\n    focused = _ref.focused,\n    session = _ref.session;\n  var _useState = (0, _react.useState)(null),\n    _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n    avatarUrl = _useState2[0],\n    setAvatarUrl = _useState2[1];\n  (0, _react.useEffect)(function () {\n    function loadAvatarUrl() {\n      return _loadAvatarUrl.apply(this, arguments);\n    }\n    function _loadAvatarUrl() {\n      _loadAvatarUrl = (0, _asyncToGenerator2.default)(function* () {\n        try {\n          if (!session.user || !session.user.id) return;\n          var _yield$supabase$from$ = yield _supabaseConfig.supabase.from('profiles').select('avatar_url').eq('id', session.user.id).single(),\n            data = _yield$supabase$from$.data,\n            error = _yield$supabase$from$.error;\n          if (error) {\n            throw error;\n          }\n          if (data && data.avatar_url) {\n            try {\n              var imageUrl = `${process.env.EXPO_PUBLIC_SUPABASE_URL}/storage/v1/object/public/avatars/${data.avatar_url}`;\n              setAvatarUrl(imageUrl);\n            } catch (error) {\n              console.error('Error downloading image:', error.message);\n              _Alert.default.alert('Error', 'Failed to download image. Please try again.');\n            }\n          }\n        } catch (error) {\n          console.error('Error loading image:', error.message);\n          _Alert.default.alert('Error', 'Failed to load image. Please try again.');\n        }\n      });\n      return _loadAvatarUrl.apply(this, arguments);\n    }\n    loadAvatarUrl();\n  }, [session]);\n  var styles = _StyleSheet.default.create({\n    image: {\n      borderRadius: dimension / 2,\n      width: dimension,\n      height: dimension,\n      borderColor: _constants.COLORS.fontColour,\n      borderWidth: focused ? 1 : 0\n    }\n  });\n  return (0, _jsxRuntime.jsx)(_View.default, {\n    children: avatarUrl ? (0, _jsxRuntime.jsx)(_Image.default, {\n      source: {\n        uri: avatarUrl\n      },\n      style: styles.image\n    }) : (0, _jsxRuntime.jsx)(_Image.default, {\n      source: _constants.images.profile,\n      style: styles.image\n    })\n  });\n}","map":{"version":3,"names":["_react","_interopRequireWildcard","require","_StyleSheet","_interopRequireDefault","_View","_Image","_ActivityIndicator","_Alert","_constants","_supabaseConfig","_jsxRuntime","_jsxFileName","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","ProfileImage","_ref","dimension","focused","session","_useState","useState","_useState2","_slicedToArray2","avatarUrl","setAvatarUrl","useEffect","loadAvatarUrl","_loadAvatarUrl","apply","arguments","_asyncToGenerator2","user","id","_yield$supabase$from$","supabase","from","select","eq","single","data","error","avatar_url","imageUrl","process","env","EXPO_PUBLIC_SUPABASE_URL","console","message","Alert","alert","styles","StyleSheet","create","image","borderRadius","width","height","borderColor","COLORS","fontColour","borderWidth","jsx","children","source","uri","style","images","profile"],"sources":["D:/Moco/PartyPilot/src/components/ProfileImage/ProfileImage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { StyleSheet, View, Image, ActivityIndicator, Alert } from 'react-native';\r\nimport { COLORS, images } from '../../constants';\r\nimport { supabase } from '../../config/supabaseConfig';\r\n\r\nexport default function ProfileImage({ dimension, focused, session }) {\r\n  const [avatarUrl, setAvatarUrl] = useState(null);\r\n\r\n  useEffect(() => {\r\n    async function loadAvatarUrl() {\r\n      try {\r\n        if (!session.user || !session.user.id) return;\r\n\r\n        const { data, error } = await supabase\r\n          .from('profiles')\r\n          .select('avatar_url')\r\n          .eq('id', session.user.id)\r\n          .single();\r\n\r\n        if (error) {\r\n          throw error;\r\n        }\r\n\r\n        if (data && data.avatar_url) {\r\n          try {\r\n            const imageUrl = `${process.env.EXPO_PUBLIC_SUPABASE_URL}/storage/v1/object/public/avatars/${data.avatar_url}`;\r\n            setAvatarUrl(imageUrl);\r\n\r\n          } catch (error) {\r\n            console.error('Error downloading image:', error.message);\r\n            Alert.alert('Error', 'Failed to download image. Please try again.');\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading image:', error.message);\r\n        Alert.alert('Error', 'Failed to load image. Please try again.');\r\n      }\r\n    }\r\n\r\n    loadAvatarUrl();\r\n  }, [session]);\r\n\r\n  const styles = StyleSheet.create({\r\n    image: {\r\n      borderRadius: dimension / 2,\r\n      width: dimension,\r\n      height: dimension,\r\n      borderColor: COLORS.fontColour,\r\n      borderWidth: focused ? 1 : 0,\r\n    },\r\n  });\r\n\r\n  return (\r\n    <View>\r\n      {avatarUrl ? (\r\n        <Image source={{ uri: avatarUrl }} style={styles.image} />\r\n      ) : (\r\n        <Image source={images.profile} style={styles.image} />\r\n      )}\r\n    </View>\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}